<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="/styles/view-page.css" />
    <title>Course Details</title>
  </head>
  <body>
    <div class="page-container">
      <div class="content-container">
        <div class="header">
          <h1>Course Details</h1>
        </div>
        <div class="content">
          <h1 class="course-name">
            <%= course.courseCode %> - <%= course.title %>
          </h1>

          <div class="course-info">
            <div class="info-item">
              <p>Description</p>
              <div class="value"><%= course.description %></div>
            </div>
            <div class="info-item">
              <p>Department</p>
              <div class="value"><%= course.department %></div>
            </div>
            <div class="info-item">
              <p>Credit Hours</p>
              <div class="value"><%= course.creditHours %></div>
            </div>
            <div class="info-item">
              <p>Status</p>
              <div class="value">
                <span
                  class="status <%= course.isActive ? 'active' : 'inactive' %>"
                >
                  <%= course.isActive ? 'Active' : 'Inactive' %>
                </span>
              </div>
            </div>

            <% if (course.prerequisites && course.prerequisites.length > 0) { %>
            <div class="info-item">
              <p>Prerequisites</p>
              <div class="value"><%= course.prerequisites.join(', ') %></div>
            </div>
            <% } %> <% const s = course.schedule; %> <% if (s && s.days?.length
            && s.time) { %>
            <div class="info-item">
              <p>Schedule</p>
              <div class="value">
                <%= s.days.join(', ') %> at <%= s.time %> <% if (s.room) { %>
                (Room: <%= s.room %>) <% } %>
              </div>
            </div>
            <% } %>
          </div>

          <h2 class="table-title">
            Enrolled Students (<%= enrolledStudents.length %>)
          </h2>
          <% if (enrolledStudents.length > 0) { %>
          <div class="table-container">
            <table>
              <thead>
                <tr>
                  <th>Student ID</th>
                  <th>Name</th>
                  <th>Email</th>
                  <th>Grade</th>
                  <th>Semester</th>
                </tr>
              </thead>
              <tbody>
                <% enrolledStudents.forEach(student => { %>
                <tr>
                  <td><%= student.studentId %></td>
                  <td><%= student.firstName %> <%= student.lastName %></td>
                  <td><%= student.email %></td>
                  <td>
                    <% if (typeof student.grade === 'number') { %> <%=
                    student.grade %> <% } else { %> N/A <% } %>
                  </td>
                  <td><%= student.semester %></td>
                </tr>
                <% }); %>
              </tbody>
            </table>
          </div>
          <% } else { %>
          <p>No students enrolled in this course.</p>
          <% } %>

          <div class="actions-bar">
            <a href="/courses/<%= course._id %>/edit" class="btn">
              Edit Course
            </a>
            <form
              action="/courses/<%= course._id %>?_method=DELETE"
              method="POST"
            >
              <button
                type="submit"
                class="btn delete-btn"
                onclick="return confirm('Are you sure you want to delete this course?')"
              >
                Delete Course
              </button>
            </form>
            <a href="/courses" class="btn">Back to All Courses</a>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
